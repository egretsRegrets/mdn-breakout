{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/js/main.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","const CANVAS = document.getElementById('myCanvas');\nconst ctx = CANVAS.getContext('2d');\n\nvar x = CANVAS.width / 2;\nvar y = CANVAS.height - 30;\nvar dx = 1.5; // x offset at each new frame\nvar dy = -1.5; // y offset at each new frame\nvar rightPressed = false;\nvar leftPressed = false;\nvar isPaused = false;\nvar score = 0;\nvar lives = 3;\n\nvar brick = {\n    rowCount: 4,\n    columnCount: 7,\n    padding: CANVAS.width * 0.01\n}\nbrick.paddingUnitNumber = brick.columnCount + 1;\nbrick.width = (CANVAS.width - (brick.paddingUnitNumber * brick.padding)) / brick.columnCount;\nbrick.height = CANVAS.height * 0.03;\n\nvar bricks = [];\nfor (c = 0; c < brick.columnCount; c++) {\n    bricks[c] = [];\n    for (r = 0; r < brick.rowCount; r++) {\n        bricks[c][r] = {x: 0, y: 0, status: 1};\n    }\n}\n\nfunction drawBricks(){\n    for (c = 0; c < brick.columnCount; c++) {\n        for (r = 0; r < brick.rowCount; r++){\n            if (bricks[c][r].status === 1) {\n                let brickX = ((c + 1) * brick.padding) + (brick.width * (c));\n                let brickY = ((r + 1) * brick.padding) + (brick.height * (r));\n                bricks[c][r].x = brickX;\n                bricks[c][r].y = brickY;\n                ctx.beginPath();\n                ctx.rect(brickX, brickY, brick.width, brick.height);\n                ctx.fillStyle = '#2D7DBC';\n                ctx.fill();\n                ctx.closePath();\n            }\n        }\n    }\n}\n\nfunction brickCollision() {\n    for (c = 0; c < brick.columnCount; c++){\n        for (r = 0; r < brick.rowCount; r++){\n            let thisBrick = bricks[c][r];\n            if (thisBrick.status === 1){\n                let ballPositionY = getBallPositionY();\n                let ballPositionX = getBallPositionX();\n                if ( ballPositionY < thisBrick.y + brick.height && ballPositionY > thisBrick.y ){\n                    if( ballPositionX < thisBrick.x + brick.width && ballPositionX > thisBrick.x){\n                        dy = -dy;\n                        thisBrick.status = 0;\n                        score += 1;\n                        if (score === brick.columnCount * brick.rowCount){\n                            isPaused = true;\n                            alert(\"win!\");\n                            document.location.reload();\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n\n\nvar ball = {\n    radius: 4,\n    color: '#7ACFD6'\n}\nball.draw = function (){\n    ctx.beginPath();\n    ctx.arc(x, y, ball.radius, 0, Math.PI * 2);\n    ctx.fillStyle = ball.color;\n    ctx.fill();\n    ctx.closePath();\n    if ( x + dx < ball.radius || x + dx > CANVAS.width - ball.radius){ // hits left limit of canvas, hit right limit of canvas\n        dx = -dx;\n    }\n    if ( y + dy < ball.radius){ // hits canvas ceiling\n        dy = -dy;\n    }\n    // hits paddle\n    if ( x + dx - ball.radius > paddle.xPos && x + dx + ball.radius < paddle.xPos + paddle.width ) { \n        if (y + dy + ball.radius >= CANVAS.height - paddle.height && y + dy < CANVAS.height) {\n            dy = -dy;\n            if (dy > -2.5){ // speed up ball up to 3px diff per frame\n                dy -= .15;\n                if(dx > 0){\n                    dx += .15;\n                }else if (dx < 0){\n                    dx -= .15;\n                }\n            }\n        }\n    }\n    // hits canvas floor\n    if (y + dy > CANVAS.height){\n        if (lives > 0){\n            lives -= 1;\n            x = paddle.xPos + paddle.width / 2;\n            y = CANVAS.height - paddle.height - ball.radius;\n            dx = 1.5;\n            dy = -1.5;\n        }else{\n            isPaused = true;\n            alert(\"GAME OVER\");\n            document.location.reload();\n        }\n    }\n}\n\nvar paddle = {\n    height: 10,\n    width: 75,\n    color: '#2D7DBC'\n};\npaddle.xPos = (CANVAS.width - paddle.width) / 2;\npaddle.draw = function(){\n    ctx.beginPath;\n    ctx.rect(paddle.xPos, CANVAS.height - paddle.height, paddle.width, paddle.height);\n    ctx.fillStyle = paddle.color;\n    ctx.fill();\n    ctx.closePath();\n    if(rightPressed && paddle.xPos < CANVAS.width - paddle.width){\n        paddle.xPos += 7;\n    }else if(leftPressed && paddle.xPos > 0){\n        paddle.xPos -= 7;\n    }\n}\n\nfunction draw() {\n    if (isPaused === false){\n        ctx.clearRect(0, 0, CANVAS.width, CANVAS.height); // clear the entire canvas before drawing\n        drawBricks();        \n        paddle.draw();\n        ball.draw();\n        brickCollision();\n        drawScore();\n        drawLives();\n\n        x += dx;\n        y += dy;\n\n        if (isPaused === false){\n            requestAnimationFrame(draw);\n        }\n    }\n}\n\ndocument.addEventListener('keydown', keyDownHandler, false);\ndocument.addEventListener('keyup', keyUpHandler, false);\ndocument.getElementsByClassName('mouse-toggle')[0].addEventListener('click', enableMouseControl, false);\n\nfunction drawScore(){\n    ctx.font = '12px Arial';\n    ctx.fillStyle = '#F45B69';\n    ctx.fillText(`Score: ${score}`, 8, CANVAS.height - 40);\n}\nfunction drawLives(){\n    ctx.font = '12px Arial';\n    ctx.fillStyle = '#F45B69';\n    ctx.fillText(`Lives: ${lives}`, 8, CANVAS.height - 25);\n}\n\nfunction getBallPositionY() {\n    let ballPositionY;\n    if (dy < 0){\n        ballPositionY = y + dy - ball.radius;\n    } else if (dy > 0){\n        ballPositionY = y + dy + ball.radius;\n    }\n    return ballPositionY;\n}\n\nfunction getBallPositionX() {\n    let ballPositionX;\n    if (dx < 0){\n        ballPositionX = x + dx - ball.radius;\n    } else if (dx > 0){\n        ballPositionX = x + dx + ball.radius;\n    }\n    return ballPositionX;\n}\n\nfunction keyDownHandler(event) {\n    if (event.keyCode === 37 || event.keyCode === 65){\n        leftPressed = true;\n    }\n    else if (event.keyCode === 39 || event.keyCode === 68){\n        rightPressed = true;\n    }\n    else if (event.keyCode === 27){\n        if (isPaused === false){\n            isPaused = true;\n        }else {\n            isPaused = false;\n            draw();\n        }\n    }\n}\n\nfunction keyUpHandler(event) {\n    if (event.keyCode === 37 || event.keyCode === 65){\n        leftPressed = false;\n    }\n    else if (event.keyCode === 39 || event.keyCode === 68){\n        rightPressed = false;\n    }\n}\n\nfunction mouseMoveHandler (event) {\n    let relativeX = event.clientX - CANVAS.offsetLeft;\n    if (relativeX - paddle.width / 2 > 0 && relativeX + paddle.width / 2 < CANVAS.width){\n        paddle.xPos = relativeX - paddle.width / 2;\n    }\n}\n\nfunction enableMouseControl (){\n    let btn = document.getElementsByClassName('mouse-toggle')[0];\n    let btnClasses = btn.classList;\n    if(!btnClasses.contains('on')){\n        btnClasses.add('on');\n        document.addEventListener('mousemove', mouseMoveHandler, false);\n    }else{\n        btnClasses.remove('on');\n        document.removeEventListener('mousemove', mouseMoveHandler, false);\n    }\n}\n\ndraw();\n\n // draw every 10miliseconds"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvbWFpbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJjb25zdCBDQU5WQVMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXlDYW52YXMnKTtcbmNvbnN0IGN0eCA9IENBTlZBUy5nZXRDb250ZXh0KCcyZCcpO1xuXG52YXIgeCA9IENBTlZBUy53aWR0aCAvIDI7XG52YXIgeSA9IENBTlZBUy5oZWlnaHQgLSAzMDtcbnZhciBkeCA9IDEuNTsgLy8geCBvZmZzZXQgYXQgZWFjaCBuZXcgZnJhbWVcbnZhciBkeSA9IC0xLjU7IC8vIHkgb2Zmc2V0IGF0IGVhY2ggbmV3IGZyYW1lXG52YXIgcmlnaHRQcmVzc2VkID0gZmFsc2U7XG52YXIgbGVmdFByZXNzZWQgPSBmYWxzZTtcbnZhciBpc1BhdXNlZCA9IGZhbHNlO1xudmFyIHNjb3JlID0gMDtcbnZhciBsaXZlcyA9IDM7XG5cbnZhciBicmljayA9IHtcbiAgICByb3dDb3VudDogNCxcbiAgICBjb2x1bW5Db3VudDogNyxcbiAgICBwYWRkaW5nOiBDQU5WQVMud2lkdGggKiAwLjAxXG59XG5icmljay5wYWRkaW5nVW5pdE51bWJlciA9IGJyaWNrLmNvbHVtbkNvdW50ICsgMTtcbmJyaWNrLndpZHRoID0gKENBTlZBUy53aWR0aCAtIChicmljay5wYWRkaW5nVW5pdE51bWJlciAqIGJyaWNrLnBhZGRpbmcpKSAvIGJyaWNrLmNvbHVtbkNvdW50O1xuYnJpY2suaGVpZ2h0ID0gQ0FOVkFTLmhlaWdodCAqIDAuMDM7XG5cbnZhciBicmlja3MgPSBbXTtcbmZvciAoYyA9IDA7IGMgPCBicmljay5jb2x1bW5Db3VudDsgYysrKSB7XG4gICAgYnJpY2tzW2NdID0gW107XG4gICAgZm9yIChyID0gMDsgciA8IGJyaWNrLnJvd0NvdW50OyByKyspIHtcbiAgICAgICAgYnJpY2tzW2NdW3JdID0ge3g6IDAsIHk6IDAsIHN0YXR1czogMX07XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcmF3QnJpY2tzKCl7XG4gICAgZm9yIChjID0gMDsgYyA8IGJyaWNrLmNvbHVtbkNvdW50OyBjKyspIHtcbiAgICAgICAgZm9yIChyID0gMDsgciA8IGJyaWNrLnJvd0NvdW50OyByKyspe1xuICAgICAgICAgICAgaWYgKGJyaWNrc1tjXVtyXS5zdGF0dXMgPT09IDEpIHtcbiAgICAgICAgICAgICAgICBsZXQgYnJpY2tYID0gKChjICsgMSkgKiBicmljay5wYWRkaW5nKSArIChicmljay53aWR0aCAqIChjKSk7XG4gICAgICAgICAgICAgICAgbGV0IGJyaWNrWSA9ICgociArIDEpICogYnJpY2sucGFkZGluZykgKyAoYnJpY2suaGVpZ2h0ICogKHIpKTtcbiAgICAgICAgICAgICAgICBicmlja3NbY11bcl0ueCA9IGJyaWNrWDtcbiAgICAgICAgICAgICAgICBicmlja3NbY11bcl0ueSA9IGJyaWNrWTtcbiAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgY3R4LnJlY3QoYnJpY2tYLCBicmlja1ksIGJyaWNrLndpZHRoLCBicmljay5oZWlnaHQpO1xuICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAnIzJEN0RCQyc7XG4gICAgICAgICAgICAgICAgY3R4LmZpbGwoKTtcbiAgICAgICAgICAgICAgICBjdHguY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGJyaWNrQ29sbGlzaW9uKCkge1xuICAgIGZvciAoYyA9IDA7IGMgPCBicmljay5jb2x1bW5Db3VudDsgYysrKXtcbiAgICAgICAgZm9yIChyID0gMDsgciA8IGJyaWNrLnJvd0NvdW50OyByKyspe1xuICAgICAgICAgICAgbGV0IHRoaXNCcmljayA9IGJyaWNrc1tjXVtyXTtcbiAgICAgICAgICAgIGlmICh0aGlzQnJpY2suc3RhdHVzID09PSAxKXtcbiAgICAgICAgICAgICAgICBsZXQgYmFsbFBvc2l0aW9uWSA9IGdldEJhbGxQb3NpdGlvblkoKTtcbiAgICAgICAgICAgICAgICBsZXQgYmFsbFBvc2l0aW9uWCA9IGdldEJhbGxQb3NpdGlvblgoKTtcbiAgICAgICAgICAgICAgICBpZiAoIGJhbGxQb3NpdGlvblkgPCB0aGlzQnJpY2sueSArIGJyaWNrLmhlaWdodCAmJiBiYWxsUG9zaXRpb25ZID4gdGhpc0JyaWNrLnkgKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoIGJhbGxQb3NpdGlvblggPCB0aGlzQnJpY2sueCArIGJyaWNrLndpZHRoICYmIGJhbGxQb3NpdGlvblggPiB0aGlzQnJpY2sueCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBkeSA9IC1keTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNCcmljay5zdGF0dXMgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcmUgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY29yZSA9PT0gYnJpY2suY29sdW1uQ291bnQgKiBicmljay5yb3dDb3VudCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNQYXVzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwid2luIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG52YXIgYmFsbCA9IHtcbiAgICByYWRpdXM6IDQsXG4gICAgY29sb3I6ICcjN0FDRkQ2J1xufVxuYmFsbC5kcmF3ID0gZnVuY3Rpb24gKCl7XG4gICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgIGN0eC5hcmMoeCwgeSwgYmFsbC5yYWRpdXMsIDAsIE1hdGguUEkgKiAyKTtcbiAgICBjdHguZmlsbFN0eWxlID0gYmFsbC5jb2xvcjtcbiAgICBjdHguZmlsbCgpO1xuICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICBpZiAoIHggKyBkeCA8IGJhbGwucmFkaXVzIHx8IHggKyBkeCA+IENBTlZBUy53aWR0aCAtIGJhbGwucmFkaXVzKXsgLy8gaGl0cyBsZWZ0IGxpbWl0IG9mIGNhbnZhcywgaGl0IHJpZ2h0IGxpbWl0IG9mIGNhbnZhc1xuICAgICAgICBkeCA9IC1keDtcbiAgICB9XG4gICAgaWYgKCB5ICsgZHkgPCBiYWxsLnJhZGl1cyl7IC8vIGhpdHMgY2FudmFzIGNlaWxpbmdcbiAgICAgICAgZHkgPSAtZHk7XG4gICAgfVxuICAgIC8vIGhpdHMgcGFkZGxlXG4gICAgaWYgKCB4ICsgZHggLSBiYWxsLnJhZGl1cyA+IHBhZGRsZS54UG9zICYmIHggKyBkeCArIGJhbGwucmFkaXVzIDwgcGFkZGxlLnhQb3MgKyBwYWRkbGUud2lkdGggKSB7IFxuICAgICAgICBpZiAoeSArIGR5ICsgYmFsbC5yYWRpdXMgPj0gQ0FOVkFTLmhlaWdodCAtIHBhZGRsZS5oZWlnaHQgJiYgeSArIGR5IDwgQ0FOVkFTLmhlaWdodCkge1xuICAgICAgICAgICAgZHkgPSAtZHk7XG4gICAgICAgICAgICBpZiAoZHkgPiAtMi41KXsgLy8gc3BlZWQgdXAgYmFsbCB1cCB0byAzcHggZGlmZiBwZXIgZnJhbWVcbiAgICAgICAgICAgICAgICBkeSAtPSAuMTU7XG4gICAgICAgICAgICAgICAgaWYoZHggPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgZHggKz0gLjE1O1xuICAgICAgICAgICAgICAgIH1lbHNlIGlmIChkeCA8IDApe1xuICAgICAgICAgICAgICAgICAgICBkeCAtPSAuMTU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8vIGhpdHMgY2FudmFzIGZsb29yXG4gICAgaWYgKHkgKyBkeSA+IENBTlZBUy5oZWlnaHQpe1xuICAgICAgICBpZiAobGl2ZXMgPiAwKXtcbiAgICAgICAgICAgIGxpdmVzIC09IDE7XG4gICAgICAgICAgICB4ID0gcGFkZGxlLnhQb3MgKyBwYWRkbGUud2lkdGggLyAyO1xuICAgICAgICAgICAgeSA9IENBTlZBUy5oZWlnaHQgLSBwYWRkbGUuaGVpZ2h0IC0gYmFsbC5yYWRpdXM7XG4gICAgICAgICAgICBkeCA9IDEuNTtcbiAgICAgICAgICAgIGR5ID0gLTEuNTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBpc1BhdXNlZCA9IHRydWU7XG4gICAgICAgICAgICBhbGVydChcIkdBTUUgT1ZFUlwiKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG52YXIgcGFkZGxlID0ge1xuICAgIGhlaWdodDogMTAsXG4gICAgd2lkdGg6IDc1LFxuICAgIGNvbG9yOiAnIzJEN0RCQydcbn07XG5wYWRkbGUueFBvcyA9IChDQU5WQVMud2lkdGggLSBwYWRkbGUud2lkdGgpIC8gMjtcbnBhZGRsZS5kcmF3ID0gZnVuY3Rpb24oKXtcbiAgICBjdHguYmVnaW5QYXRoO1xuICAgIGN0eC5yZWN0KHBhZGRsZS54UG9zLCBDQU5WQVMuaGVpZ2h0IC0gcGFkZGxlLmhlaWdodCwgcGFkZGxlLndpZHRoLCBwYWRkbGUuaGVpZ2h0KTtcbiAgICBjdHguZmlsbFN0eWxlID0gcGFkZGxlLmNvbG9yO1xuICAgIGN0eC5maWxsKCk7XG4gICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgIGlmKHJpZ2h0UHJlc3NlZCAmJiBwYWRkbGUueFBvcyA8IENBTlZBUy53aWR0aCAtIHBhZGRsZS53aWR0aCl7XG4gICAgICAgIHBhZGRsZS54UG9zICs9IDc7XG4gICAgfWVsc2UgaWYobGVmdFByZXNzZWQgJiYgcGFkZGxlLnhQb3MgPiAwKXtcbiAgICAgICAgcGFkZGxlLnhQb3MgLT0gNztcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYXcoKSB7XG4gICAgaWYgKGlzUGF1c2VkID09PSBmYWxzZSl7XG4gICAgICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgQ0FOVkFTLndpZHRoLCBDQU5WQVMuaGVpZ2h0KTsgLy8gY2xlYXIgdGhlIGVudGlyZSBjYW52YXMgYmVmb3JlIGRyYXdpbmdcbiAgICAgICAgZHJhd0JyaWNrcygpOyAgICAgICAgXG4gICAgICAgIHBhZGRsZS5kcmF3KCk7XG4gICAgICAgIGJhbGwuZHJhdygpO1xuICAgICAgICBicmlja0NvbGxpc2lvbigpO1xuICAgICAgICBkcmF3U2NvcmUoKTtcbiAgICAgICAgZHJhd0xpdmVzKCk7XG5cbiAgICAgICAgeCArPSBkeDtcbiAgICAgICAgeSArPSBkeTtcblxuICAgICAgICBpZiAoaXNQYXVzZWQgPT09IGZhbHNlKXtcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShkcmF3KTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGtleURvd25IYW5kbGVyLCBmYWxzZSk7XG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGtleVVwSGFuZGxlciwgZmFsc2UpO1xuZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnbW91c2UtdG9nZ2xlJylbMF0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlbmFibGVNb3VzZUNvbnRyb2wsIGZhbHNlKTtcblxuZnVuY3Rpb24gZHJhd1Njb3JlKCl7XG4gICAgY3R4LmZvbnQgPSAnMTJweCBBcmlhbCc7XG4gICAgY3R4LmZpbGxTdHlsZSA9ICcjRjQ1QjY5JztcbiAgICBjdHguZmlsbFRleHQoYFNjb3JlOiAke3Njb3JlfWAsIDgsIENBTlZBUy5oZWlnaHQgLSA0MCk7XG59XG5mdW5jdGlvbiBkcmF3TGl2ZXMoKXtcbiAgICBjdHguZm9udCA9ICcxMnB4IEFyaWFsJztcbiAgICBjdHguZmlsbFN0eWxlID0gJyNGNDVCNjknO1xuICAgIGN0eC5maWxsVGV4dChgTGl2ZXM6ICR7bGl2ZXN9YCwgOCwgQ0FOVkFTLmhlaWdodCAtIDI1KTtcbn1cblxuZnVuY3Rpb24gZ2V0QmFsbFBvc2l0aW9uWSgpIHtcbiAgICBsZXQgYmFsbFBvc2l0aW9uWTtcbiAgICBpZiAoZHkgPCAwKXtcbiAgICAgICAgYmFsbFBvc2l0aW9uWSA9IHkgKyBkeSAtIGJhbGwucmFkaXVzO1xuICAgIH0gZWxzZSBpZiAoZHkgPiAwKXtcbiAgICAgICAgYmFsbFBvc2l0aW9uWSA9IHkgKyBkeSArIGJhbGwucmFkaXVzO1xuICAgIH1cbiAgICByZXR1cm4gYmFsbFBvc2l0aW9uWTtcbn1cblxuZnVuY3Rpb24gZ2V0QmFsbFBvc2l0aW9uWCgpIHtcbiAgICBsZXQgYmFsbFBvc2l0aW9uWDtcbiAgICBpZiAoZHggPCAwKXtcbiAgICAgICAgYmFsbFBvc2l0aW9uWCA9IHggKyBkeCAtIGJhbGwucmFkaXVzO1xuICAgIH0gZWxzZSBpZiAoZHggPiAwKXtcbiAgICAgICAgYmFsbFBvc2l0aW9uWCA9IHggKyBkeCArIGJhbGwucmFkaXVzO1xuICAgIH1cbiAgICByZXR1cm4gYmFsbFBvc2l0aW9uWDtcbn1cblxuZnVuY3Rpb24ga2V5RG93bkhhbmRsZXIoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMzcgfHwgZXZlbnQua2V5Q29kZSA9PT0gNjUpe1xuICAgICAgICBsZWZ0UHJlc3NlZCA9IHRydWU7XG4gICAgfVxuICAgIGVsc2UgaWYgKGV2ZW50LmtleUNvZGUgPT09IDM5IHx8IGV2ZW50LmtleUNvZGUgPT09IDY4KXtcbiAgICAgICAgcmlnaHRQcmVzc2VkID0gdHJ1ZTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMjcpe1xuICAgICAgICBpZiAoaXNQYXVzZWQgPT09IGZhbHNlKXtcbiAgICAgICAgICAgIGlzUGF1c2VkID0gdHJ1ZTtcbiAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgaXNQYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGRyYXcoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24ga2V5VXBIYW5kbGVyKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDM3IHx8IGV2ZW50LmtleUNvZGUgPT09IDY1KXtcbiAgICAgICAgbGVmdFByZXNzZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMzkgfHwgZXZlbnQua2V5Q29kZSA9PT0gNjgpe1xuICAgICAgICByaWdodFByZXNzZWQgPSBmYWxzZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG1vdXNlTW92ZUhhbmRsZXIgKGV2ZW50KSB7XG4gICAgbGV0IHJlbGF0aXZlWCA9IGV2ZW50LmNsaWVudFggLSBDQU5WQVMub2Zmc2V0TGVmdDtcbiAgICBpZiAocmVsYXRpdmVYIC0gcGFkZGxlLndpZHRoIC8gMiA+IDAgJiYgcmVsYXRpdmVYICsgcGFkZGxlLndpZHRoIC8gMiA8IENBTlZBUy53aWR0aCl7XG4gICAgICAgIHBhZGRsZS54UG9zID0gcmVsYXRpdmVYIC0gcGFkZGxlLndpZHRoIC8gMjtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGVuYWJsZU1vdXNlQ29udHJvbCAoKXtcbiAgICBsZXQgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnbW91c2UtdG9nZ2xlJylbMF07XG4gICAgbGV0IGJ0bkNsYXNzZXMgPSBidG4uY2xhc3NMaXN0O1xuICAgIGlmKCFidG5DbGFzc2VzLmNvbnRhaW5zKCdvbicpKXtcbiAgICAgICAgYnRuQ2xhc3Nlcy5hZGQoJ29uJyk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG1vdXNlTW92ZUhhbmRsZXIsIGZhbHNlKTtcbiAgICB9ZWxzZXtcbiAgICAgICAgYnRuQ2xhc3Nlcy5yZW1vdmUoJ29uJyk7XG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG1vdXNlTW92ZUhhbmRsZXIsIGZhbHNlKTtcbiAgICB9XG59XG5cbmRyYXcoKTtcblxuIC8vIGRyYXcgZXZlcnkgMTBtaWxpc2Vjb25kcyJdfQ=="}